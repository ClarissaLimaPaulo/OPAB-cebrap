<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Observat√≥rio de Assassinatos Pol√≠ticos (OAP)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1e3c72;
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            min-height: 100vh;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
        }

        .header {
            background: #1e3c72;
            color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Header layout styles */
        .header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo-left, .logo-right {
            flex-shrink: 0;
            display: flex;
            align-items: center;
        }

        .header-logo {
            max-width: 90px;
            max-height: 65px;
            width: auto;
            height: auto;
            object-fit: contain;
        }

        .header-text {
            text-align: center;
            flex-grow: 1;
            margin: 0 2rem;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            background: #2c3e50;
            overflow-x: auto;
        }

        .tab {
            background: #34495e;
            border: none;
            color: white;
            padding: 1rem 2rem;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1rem;
            white-space: nowrap;
            border-bottom: 3px solid transparent;
        }

        .tab:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .tab.active {
            background: #27ae60;
            border-bottom-color: #2ecc71;
        }

        .content {
            padding: 2rem;
            min-height: 600px;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 1.5rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            transform: translateY(0);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .controls {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .filter-group {
            display: inline-block;
            margin: 0.5rem 1rem 0.5rem 0;
        }

        .filter-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .filter-group select {
            padding: 0.5rem;
            border: 2px solid #ddd;
            border-radius: 5px;
            background: white;
            min-width: 150px;
        }

        #map {
            height: 500px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .timeline-container {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            height: 500px;
            overflow-y: auto;
        }

        .event-item {
            padding: 1rem;
            margin: 0.5rem 0;
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .event-item:hover {
            background: #e8f4f8;
            transform: translateX(5px);
        }

        .event-header {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .event-details {
            display: none;
            padding-top: 0.5rem;
            border-top: 1px solid #ddd;
            margin-top: 0.5rem;
        }

        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin: 1rem 0;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            .header h1 {
                font-size: 2rem;
            }
            .tabs {
                flex-direction: column;
            }
        }

        .presidential-term {
            background: #e8f4f8;
            margin: 1rem 0;
            padding: 1rem;
            border-left: 4px solid #3498db;
            border-radius: 5px;
        }

        .term-title {
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="logo-left">
                    <img src="https://raw.githubusercontent.com/ClarissaLimaPaulo/observatorio-assassinatos-politicos/main/cebrap.png" alt="Cebrap Logo" class="header-logo">
                </div>
                <div class="header-text">
                    <h1>Observat√≥rio de Assassinatos Pol√≠ticos</h1>
                    <p>Base de Dados de Assassinatos Pol√≠ticos Brasileiros (BAP-Cebrap) ‚Ä¢ 2003-2023</p>
                </div>
                <div class="logo-right">
                    <img src="https://raw.githubusercontent.com/ClarissaLimaPaulo/observatorio-assassinatos-politicos/main/usp-logo.png" alt="USP Logo" class="header-logo">
                </div>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab active" onclick="showTab('home')">üè† In√≠cio</button>
            <button class="tab" onclick="showTab('map')">üó∫Ô∏è Mapa</button>
            <button class="tab" onclick="showTab('timeline')">üìÖ Linha do Tempo</button>
            <button class="tab" onclick="showTab('data')">üìä Dados</button>
        </nav>

        <main class="content">
            <!-- HOME TAB -->
            <div id="home" class="tab-content active">
                <p style="font-size: 1.1rem; line-height: 1.8; margin: 1.5rem 0;">
                    Levantamento e an√°lise de letalidade pol√≠tica no Brasil, com objetivo de observar uma rela√ß√£o entre viol√™ncia pol√≠tica e hierarquia social, al√©m de padr√µes recorrentes de viol√™ncia pol√≠tica que se cristalizam em estilos de assassinato pol√≠tico.<br><br>
                    Coordenadora: Angela Alonso (USP/Cebrap)<br>
                    Pesquisadores: Clarissa Lima, Daniel William Ferreira Pinto, Guilherme Ol√≠mpio Fagundes, J√©ssica H√∂ring, Jos√© Oliveira, Patricia Rezende, Paulo Castro, Rafaela Pannain, Sama√©rika Sousa e Viviane Brito. <br>
                </p>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="total-cases">40</div>
                        <div>Total de Casos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-deaths">23</div>
                        <div>Assassinatos</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-attempts">17</div>
                        <div>Tentativas</div>
                    </div>
                </div>

                <h3 style="margin-top: 2rem; color: #2c3e50;">Funcionalidades</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin: 1.5rem 0;">
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #3498db;">
                        <h4>üó∫Ô∏è Mapa Interativo</h4>
                        <p>Visualize a distribui√ß√£o geogr√°fica dos casos com filtros por g√™nero, ocupa√ß√£o, ano, m√©todo e motiva√ß√£o.</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #27ae60;">
                        <h4>üìÖ Linha do Tempo</h4>
                        <p>Explore a evolu√ß√£o temporal dos casos organizados por mandatos presidenciais.</p>
                    </div>
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; border-left: 4px solid #2c3e50;">
                        <h4>üìä An√°lise de Dados</h4>
                        <p>Gr√°ficos e estat√≠sticas detalhadas sobre padr√µes e tend√™ncias dos assassinatos pol√≠ticos.</p>
                    </div>
                </div>
            </div>

            <!-- MAP TAB -->
            <div id="map-tab" class="tab-content">
                <h2>Mapa Interativo dos Casos</h2>
                
                <div class="controls">
                    <div class="filter-group">
                        <label for="gender-filter">G√™nero:</label>
                        <select id="gender-filter" onchange="filterMap()">
                            <option value="">Todos</option>
                            <option value="Homem">Homem</option>
                            <option value="Mulher">Mulher</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="year-filter">Ano:</label>
                        <select id="year-filter" onchange="filterMap()">
                            <option value="">Todos</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="type-filter">Tipo:</label>
                        <select id="type-filter" onchange="filterMap()">
                            <option value="">Todos</option>
                            <option value="Assassinato">Assassinato</option>
                            <option value="Tentativa de assassinato">Tentativa</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <label for="motive-filter">Motiva√ß√£o:</label>
                        <select id="motive-filter" onchange="filterMap()">
                            <option value="">Todos</option>
                        </select>
                    </div>
                </div>

                <div id="map"></div>
            </div>

            <!-- TIMELINE TAB -->
            <div id="timeline-tab" class="tab-content">
                <h2>Linha do Tempo por Mandatos Presidenciais</h2>
                
                <div class="timeline-container">
                    <canvas id="timelineChart"></canvas>
                </div>

                <div id="presidential-terms">
                    <div class="presidential-term">
                        <div class="term-title">Luiz In√°cio Lula da Silva (2003-2010)</div>
                        <div>Casos registrados: <span id="lula-cases">0</span></div>
                    </div>
                    <div class="presidential-term">
                        <div class="term-title">Dilma Rousseff (2011-2016)</div>
                        <div>Casos registrados: <span id="dilma-cases">0</span></div>
                    </div>
                    <div class="presidential-term">
                        <div class="term-title">Michel Temer (2016-2018)</div>
                        <div>Casos registrados: <span id="temer-cases">0</span></div>
                    </div>
                    <div class="presidential-term">
                        <div class="term-title">Jair Bolsonaro (2019-2022)</div>
                        <div>Casos registrados: <span id="bolsonaro-cases">0</span></div>
                    </div>
                    <div class="presidential-term">
                        <div class="term-title">Luiz In√°cio Lula da Silva (2023-presente)</div>
                        <div>Casos registrados: <span id="lula2-cases">0</span></div>
                    </div>
                </div>
            </div>
            
            <!-- DATA TAB -->
            <div id="data-tab" class="tab-content">
                <h2>An√°lise dos Dados</h2>
                
                <div class="chart-grid">
                    <div class="chart-container">
                        <h3>Distribui√ß√£o por G√™nero</h3>
                        <canvas id="genderChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Casos por Estado</h3>
                        <canvas id="stateChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>M√©todos Utilizados</h3>
                        <canvas id="methodChart"></canvas>
                    </div>
                    <div class="chart-container">
                        <h3>Motiva√ß√µes dos Crimes</h3>
                        <canvas id="motiveChart"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <h3>Evolu√ß√£o Temporal dos Casos</h3>
                    <canvas id="yearChart"></canvas>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Data from CSV (synthetic data)
        const csvData = `ID_Evento,Tipo_a√ß√£o_v√≠tima,Caso,V√≠tima_Nome,Civil_(Apelido/Nome Social),V√≠tima_Nacionalidade,V√≠tima_Ocupa√ß√£o_1,V√≠tima_Ocupa√ß√£o_2,V√≠tima_Ocupa√ß√£o_3,V√≠tima_G√™nero/Sexo,V√≠tima_Orienta√ß√£oSexual,M√™s,Ano,Regi√£o,UF,Cidade,Instrumento_1,M√©todo_1,Disputa,Latitude,Longitude
FICT001,Assassinato,Caso Ana Gomes Souza,Camila Souza Ferreira,,Brasileira,Pecuarista,,,Homem,,8,2007,,RJ,Niter√≥i,Pancada,Agredido,Disputa por recursos,-5.532301,-57.0766
FICT002,Assassinato,Caso Luciana Ferreira Lima,Carlos Gomes Silva,,Brasileira,Professor,,,Mulher,,12,2023,,PA,Bel√©m,Faca,Envenenado,Disputa por recursos,-7.117285,-53.046653
FICT003,Assassinato,Caso Camila Pereira Oliveira,Ana Costa Gomes,,Brasileira,Juiz,,,Mulher,,7,2007,,BA,Salvador,Envenenamento,Esfaqueado,Conflito agr√°rio,-31.252484,-46.053376
FICT004,Tentativa de assassinato,Caso Jo√£o Almeida Oliveira,Pedro Santos Souza,,Brasileira,Motorista,,,Mulher,,4,2006,,AL,Arapiraca,Faca,Baleado,Viol√™ncia eleitoral,-24.586273,-56.475962
FICT005,Tentativa de assassinato,Caso Rafael Santos Ferreira,Carlos Ferreira Costa,,Brasileira,L√≠der comunit√°rio,,,Homem,,6,2016,,BA,Salvador,Envenenamento,Envenenado,Conflito agr√°rio,-4.575539,-66.38893
FICT006,Tentativa de assassinato,Caso Carlos Santos Souza,Camila Lima Santos,,Brasileira,Pecuarista,,,Mulher,,2,2007,,CE,Sobral,Faca,Envenenado,Disputa por recursos,-30.06928,-49.535909
FICT007,Tentativa de assassinato,Caso Jo√£o Gomes Santos,Juliana Lima Costa,,Brasileira,Vereador,,,Homem,,2,2007,,AM,Manaus,Envenenamento,Baleado,Viol√™ncia eleitoral,-12.682219,-36.952949
FICT008,Assassinato,Caso Camila Pereira Oliveira,Fernando Almeida Costa,,Brasileira,L√≠der comunit√°rio,,,Homem,,3,2020,,PE,Olinda,Pancada,Esfaqueado,Disputa pol√≠tica local,-3.338048,-35.615975
FICT009,Tentativa de assassinato,Caso Jo√£o Almeida Oliveira,Juliana Souza Souza,,Brasileira,L√≠der comunit√°rio,,,Homem,,5,2005,,RS,Porto Alegre,Arma de fogo,Envenenado,Viol√™ncia eleitoral,-27.996105,-67.97306
FICT010,Tentativa de assassinato,Caso Pedro Lima Costa,Fernando Gomes Gomes,,Brasileira,Juiz,,,Mulher,,7,2011,,AM,Manaus,Pancada,Esfaqueado,Disputa pol√≠tica local,-27.354612,-71.809946
FICT011,Tentativa de assassinato,Caso Camila Pereira Almeida,Ana Oliveira Souza,,Brasileira,Pecuarista,,,Mulher,,4,2010,,SP,S√£o Paulo,Envenenamento,Agredido,Disputa pol√≠tica local,-5.672808,-56.602415
FICT012,Tentativa de assassinato,Caso Fernando Souza Gomes,Mariana Ferreira Costa,,Brasileira,Radialista,,,Mulher,,8,2003,,PE,Recife,Arma de fogo,Esfaqueado,Disputa por recursos,-27.265559,-50.802035
FICT013,Tentativa de assassinato,Caso Ana Lima Ferreira,Carlos Almeida Santos,,Brasileira,Pecuarista,,,Homem,,1,2005,,BA,Salvador,Arma de fogo,Baleado,Viol√™ncia eleitoral,-4.771796,-65.660042
FICT014,Tentativa de assassinato,Caso Rafael Souza Silva,Jo√£o Costa Souza,,Brasileira,Professor,,,Mulher,,11,2015,,RJ,Rio de Janeiro,Envenenamento,Esfaqueado,Viol√™ncia eleitoral,-19.002743,-44.945945
FICT015,Assassinato,Caso Camila Silva Silva,Luciana Ferreira Gomes,,Brasileira,Pecuarista,,,Homem,,9,2009,,AM,Itacoatiara,Faca,Esfaqueado,Disputa pol√≠tica local,-5.248086,-47.710516
FICT016,Assassinato,Caso Rafael Silva Gomes,Luciana Lima Silva,,Brasileira,L√≠der comunit√°rio,,,Homem,,11,2008,,AM,Manaus,Faca,Agredido,Viol√™ncia eleitoral,-19.53777,-44.512656
FICT017,Tentativa de assassinato,Caso Juliana Oliveira Gomes,Camila Lima Lima,,Brasileira,Juiz,,,Mulher,,12,2005,,RJ,Niter√≥i,Arma de fogo,Esfaqueado,Disputa por recursos,-23.755289,-48.83394
FICT018,Assassinato,Caso Ana Santos Gomes,Ana Silva Pereira,,Brasileira,Pecuarista,,,Homem,,11,2010,,CE,Fortaleza,Faca,Esfaqueado,Conflito agr√°rio,-3.90508,-60.403511
FICT019,Tentativa de assassinato,Caso Fernando Almeida Costa,Juliana Almeida Gomes,,Brasileira,Vereador,,,Homem,,8,2022,,BA,Ilh√©us,Arma de fogo,Envenenado,Disputa pol√≠tica local,-18.497563,-46.365139
FICT020,Assassinato,Caso Juliana Pereira Lima,Pedro Silva Ferreira,,Brasileira,Motorista,,,Homem,,9,2011,,AL,Arapiraca,Arma de fogo,Baleado,Viol√™ncia eleitoral,-29.9645,-72.648015
FICT021,Tentativa de assassinato,Caso Mariana Santos Pereira,Juliana Oliveira Santos,,Brasileira,Radialista,,,Mulher,,10,2004,,PE,Recife,Faca,Baleado,Viol√™ncia eleitoral,-17.330861,-68.402306
FICT022,Tentativa de assassinato,Caso Ana Gomes Santos,Fernando Costa Santos,,Brasileira,Juiz,,,Homem,,6,2003,,CE,Sobral,Envenenamento,Envenenado,Disputa por recursos,-17.965136,-70.647977
FICT023,Tentativa de assassinato,Caso Luciana Lima Pereira,Camila Silva Gomes,,Brasileira,Motorista,,,Mulher,,12,2016,,CE,Juazeiro do Norte,Pancada,Baleado,Conflito agr√°rio,-26.827599,-71.601808
FICT024,Assassinato,Caso Jo√£o Costa Almeida,Mariana Gomes Gomes,,Brasileira,Motorista,,,Homem,,2,2015,,SP,Campinas,Pancada,Esfaqueado,Disputa pol√≠tica local,-19.478826,-62.420645
FICT025,Assassinato,Caso Jo√£o Silva Gomes,Luciana Silva Oliveira,,Brasileira,Juiz,,,Homem,,4,2011,,CE,Fortaleza,Envenenamento,Agredido,Disputa pol√≠tica local,-29.60169,-65.043593
FICT026,Tentativa de assassinato,Caso Luciana Santos Pereira,Luciana Ferreira Oliveira,,Brasileira,Pecuarista,,,Homem,,2,2011,,MG,Uberl√¢ndia,Arma de fogo,Agredido,Disputa pol√≠tica local,-28.822659,-47.751248
FICT027,Assassinato,Caso Juliana Costa Ferreira,Carlos Almeida Oliveira,,Brasileira,Pastor,,,Homem,,6,2021,,BA,Feira de Santana,Faca,Envenenado,Conflito agr√°rio,-21.553904,-49.66611
FICT028,Assassinato,Caso Fernando Oliveira Oliveira,Camila Pereira Pereira,,Brasileira,Juiz,,,Mulher,,4,2010,,MG,Contagem,Faca,Esfaqueado,Conflito agr√°rio,-26.179688,-49.551334
FICT029,Assassinato,Caso Fernando Souza Almeida,Juliana Santos Costa,,Brasileira,L√≠der comunit√°rio,,,Homem,,10,2004,,BA,Ilh√©us,Faca,Esfaqueado,Viol√™ncia eleitoral,-22.634099,-49.621047
FICT030,Assassinato,Caso Fernando Oliveira Santos,Jo√£o Costa Almeida,,Brasileira,Vereador,,,Mulher,,7,2014,,RJ,Niter√≥i,Pancada,Envenenado,Conflito agr√°rio,-31.059375,-67.633817
FICT031,Assassinato,Caso Pedro Oliveira Silva,Carlos Almeida Lima,,Brasileira,Pecuarista,,,Homem,,6,2018,,RJ,Niter√≥i,Envenenamento,Esfaqueado,Disputa por recursos,-15.946625,-37.649596
FICT032,Tentativa de assassinato,Caso Carlos Ferreira Souza,Luciana Souza Silva,,Brasileira,L√≠der comunit√°rio,,,Homem,,11,2006,,PE,Recife,Arma de fogo,Esfaqueado,Viol√™ncia eleitoral,-30.933956,-45.459167
FICT033,Assassinato,Caso Fernando Almeida Silva,Camila Gomes Lima,,Brasileira,Motorista,,,Mulher,,5,2013,,MG,Belo Horizonte,Pancada,Envenenado,Viol√™ncia eleitoral,-23.667427,-53.826181
FICT034,Tentativa de assassinato,Caso Fernando Lima Souza,Ana Lima Pereira,,Brasileira,Vereador,,,Mulher,,12,2008,,MG,Belo Horizonte,Arma de fogo,Agredido,Conflito agr√°rio,-18.228927,-53.406222
FICT035,Assassinato,Caso Luciana Costa Souza,Fernando Lima Oliveira,,Brasileira,Juiz,,,Homem,,8,2007,,PE,Caruaru,Arma de fogo,Baleado,Viol√™ncia eleitoral,-31.413334,-52.442106
FICT036,Tentativa de assassinato,Caso Jo√£o Almeida Gomes,Juliana Silva Pereira,,Brasileira,Radialista,,,Homem,,4,2011,,RS,Caxias do Sul,Arma de fogo,Agredido,Disputa por recursos,-26.236853,-45.134175
FICT037,Assassinato,Caso Mariana Almeida Souza,Rafael Pereira Lima,,Brasileira,Vereador,,,Homem,,11,2004,,BA,Feira de Santana,Pancada,Esfaqueado,Viol√™ncia eleitoral,-21.552369,-63.092831
FICT038,Tentativa de assassinato,Caso Fernando Lima Lima,Fernando Silva Silva,,Brasileira,Motorista,,,Homem,,4,2020,,PA,Marab√°,Arma de fogo,Baleado,Disputa pol√≠tica local,-3.506844,-45.571224
FICT039,Assassinato,Caso Carlos Pereira Santos,Fernando Souza Ferreira,,Brasileira,Motorista,,,Mulher,,5,2015,,AM,Parintins,Envenenamento,Agredido,Conflito agr√°rio,-5.164762,-60.30976
FICT040,Tentativa de assassinato,Caso Pedro Costa Lima,Ana Souza Gomes,,Brasileira,L√≠der comunit√°rio,,,Mulher,,1,2020,,SP,Santos,Arma de fogo,Envenenado,Viol√™ncia eleitoral,-17.494211,-57.967883`;

        let data = [];
        let map, markers = [];

        // Parse CSV data
        function parseCSV() {
            const lines = csvData.trim().split('\n');
            const headers = lines[0].split(',');
            data = lines.slice(1).map(line => {
                const values = line.split(',');
                const obj = {};
                headers.forEach((header, i) => {
                    obj[header] = values[i] || '';
                });
                return obj;
            });
            
            // Populate filter dropdowns
            populateFilters();
        }

        function populateFilters() {
            // Years
            const years = [...new Set(data.map(d => d.Ano))].sort();
            const yearSelect = document.getElementById('year-filter');
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                yearSelect.appendChild(option);
            });

            // Motives
            const motives = [...new Set(data.map(d => d.Disputa))].filter(m => m);
            const motiveSelect = document.getElementById('motive-filter');
            motives.forEach(motive => {
                const option = document.createElement('option');
                option.value = motive;
                option.textContent = motive;
                motiveSelect.appendChild(option);
            });
        }

        // Tab functionality
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName === 'map' ? 'map-tab' : 
                                  tabName === 'timeline' ? 'timeline-tab' :
                                  tabName === 'data' ? 'data-tab' : 'home').classList.add('active');
            
            // Update active tab button
            event.target.classList.add('active');

            // Initialize specific tab content
            if (tabName === 'map') {
                setTimeout(initMap, 100);
            } else if (tabName === 'timeline') {
                setTimeout(initTimeline, 100);
            } else if (tabName === 'data') {
                setTimeout(initDataCharts, 100);
            }
        }

        // Map functionality
        function initMap() {
            if (map) {
                map.remove();
            }
            
            map = L.map('map', {
                zoomControl: false,
                attributionControl: false
            }).setView([-15.7942, -47.8822], 4);
            
            // Add gray base map
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
                maxZoom: 19,
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(map);

            updateMapMarkers();
        }

        function updateMapMarkers() {
            // Clear existing markers
            markers.forEach(marker => map.removeLayer(marker));
            markers = [];

            // Filter data
            const filtered = getFilteredData();

            // Add markers
            filtered.forEach(item => {
                if (item.Latitude && item.Longitude) {
                    const lat = parseFloat(item.Latitude);
                    const lng = parseFloat(item.Longitude);
                    
                    const color = item['Tipo_a√ß√£o_v√≠tima'] === 'Assassinato' ? '#e74c3c' : '#f39c12';
                    
                    const marker = L.circleMarker([lat, lng], {
                        color: color,
                        fillColor: color,
                        fillOpacity: 0.7,
                        radius: 8
                    }).addTo(map);

                    const popupContent = `
                        <strong>${item['V√≠tima_Nome']}</strong><br>
                        <strong>Tipo:</strong> ${item['Tipo_a√ß√£o_v√≠tima']}<br>
                        <strong>Ocupa√ß√£o:</strong> ${item['V√≠tima_Ocupa√ß√£o_1']}<br>
                        <strong>Local:</strong> ${item.Cidade}, ${item.UF}<br>
                        <strong>Data:</strong> ${item.M√™s}/${item.Ano}<br>
                        <strong>Motiva√ß√£o:</strong> ${item.Disputa}<br>
                        <strong>M√©todo:</strong> ${item['M√©todo_1']}
                    `;
                    
                    marker.bindPopup(popupContent);
                    markers.push(marker);
                }
            });
        }

        function filterMap() {
            updateMapMarkers();
        }

        function getFilteredData() {
            const genderFilter = document.getElementById('gender-filter').value;
            const yearFilter = document.getElementById('year-filter').value;
            const typeFilter = document.getElementById('type-filter').value;
            const motiveFilter = document.getElementById('motive-filter').value;

            return data.filter(item => {
                return (!genderFilter || item['V√≠tima_G√™nero/Sexo'] === genderFilter) &&
                       (!yearFilter || item.Ano === yearFilter) &&
                       (!typeFilter || item['Tipo_a√ß√£o_v√≠tima'] === typeFilter) &&
                       (!motiveFilter || item.Disputa === motiveFilter);
            });
        }

        // Timeline functionality
        function initTimeline() {
            const ctx = document.getElementById('timelineChart').getContext('2d');
            
            // Group data by year
            const yearCounts = {};
            data.forEach(item => {
                const year = item.Ano;
                yearCounts[year] = (yearCounts[year] || 0) + 1;
            });

            const years = Object.keys(yearCounts).sort();
            const counts = years.map(year => yearCounts[year]);

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Casos por Ano',
                        data: counts,
                        borderColor: '#3498db',
                        backgroundColor: 'rgba(52, 152, 219, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: true
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });

            // Update presidential term counts
            updatePresidentialTerms();
        }

        function updatePresidentialTerms() {
            const lulaYears1 = ['2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010'];
            const dilmaYears = ['2011', '2012', '2013', '2014', '2015', '2016'];
            const temerYears = ['2016', '2017', '2018'];
            const bolsonaroYears = ['2019', '2020', '2021', '2022'];
            const lulaYears2 = ['2023'];

            const lulaCases1 = data.filter(d => lulaYears1.includes(d.Ano)).length;
            const dilmaCases = data.filter(d => dilmaYears.includes(d.Ano)).length;
            const temerCases = data.filter(d => temerYears.includes(d.Ano)).length;
            const bolsonaroCases = data.filter(d => bolsonaroYears.includes(d.Ano)).length;
            const lulaCases2 = data.filter(d => lulaYears2.includes(d.Ano)).length;

            document.getElementById('lula-cases').textContent = lulaCases1;
            document.getElementById('dilma-cases').textContent = dilmaCases;
            document.getElementById('temer-cases').textContent = temerCases;
            document.getElementById('bolsonaro-cases').textContent = bolsonaroCases;
            document.getElementById('lula2-cases').textContent = lulaCases2;
        }

        // Data charts functionality
        function initDataCharts() {
            createGenderChart();
            createStateChart();
            createMethodChart();
            createMotiveChart();
            createYearChart();
        }

        function createGenderChart() {
            const ctx = document.getElementById('genderChart').getContext('2d');
            const genderCounts = {};
            data.forEach(item => {
                const gender = item['V√≠tima_G√™nero/Sexo'];
                genderCounts[gender] = (genderCounts[gender] || 0) + 1;
            });

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(genderCounts),
                    datasets: [{
                        data: Object.values(genderCounts),
                        backgroundColor: ['#3498db', '#2ecc71'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createStateChart() {
            const ctx = document.getElementById('stateChart').getContext('2d');
            const stateCounts = {};
            data.forEach(item => {
                const state = item.UF;
                stateCounts[state] = (stateCounts[state] || 0) + 1;
            });

            const sortedStates = Object.entries(stateCounts)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: sortedStates.map(([state]) => state),
                    datasets: [{
                        label: 'Casos por Estado',
                        data: sortedStates.map(([,count]) => count),
                        backgroundColor: '#2980b9',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function createMethodChart() {
            const ctx = document.getElementById('methodChart').getContext('2d');
            const methodCounts = {};
            data.forEach(item => {
                const method = item['M√©todo_1'];
                methodCounts[method] = (methodCounts[method] || 0) + 1;
            });

            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(methodCounts),
                    datasets: [{
                        data: Object.values(methodCounts),
                        backgroundColor: ['#3498db', '#2ecc71', '#2980b9', '#27ae60', '#1abc9c'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createMotiveChart() {
            const ctx = document.getElementById('motiveChart').getContext('2d');
            const motiveCounts = {};
            data.forEach(item => {
                const motive = item.Disputa;
                if (motive) {
                    motiveCounts[motive] = (motiveCounts[motive] || 0) + 1;
                }
            });

            const motiveLabels = Object.keys(motiveCounts).map(label => 
                label.length > 15 ? label.substring(0, 15) + '...' : label
            );

            new Chart(ctx, {
                type: 'horizontalBar',
                data: {
                    labels: motiveLabels,
                    datasets: [{
                        label: 'Casos por Motiva√ß√£o',
                        data: Object.values(motiveCounts),
                        backgroundColor: '#2c3e50',
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function createYearChart() {
            const ctx = document.getElementById('yearChart').getContext('2d');
            
            const yearCounts = {};
            const assassinatos = {};
            const tentativas = {};
            
            data.forEach(item => {
                const year = item.Ano;
                const type = item['Tipo_a√ß√£o_v√≠tima'];
                
                yearCounts[year] = (yearCounts[year] || 0) + 1;
                
                if (type === 'Assassinato') {
                    assassinatos[year] = (assassinatos[year] || 0) + 1;
                } else {
                    tentativas[year] = (tentativas[year] || 0) + 1;
                }
            });

            const years = Object.keys(yearCounts).sort();

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [
                        {
                            label: 'Assassinatos',
                            data: years.map(year => assassinatos[year] || 0),
                            backgroundColor: '#e74c3c',
                            borderRadius: 5
                        },
                        {
                            label: 'Tentativas',
                            data: years.map(year => tentativas[year] || 0),
                            backgroundColor: '#f39c12',
                            borderRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            stacked: true
                        },
                        y: {
                            stacked: true,
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    }
                }
            });
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            parseCSV();
            
            // Update homepage statistics
            const totalCases = data.length;
            const totalDeaths = data.filter(d => d['Tipo_a√ß√£o_v√≠tima'] === 'Assassinato').length;
            const totalAttempts = data.filter(d => d['Tipo_a√ß√£o_v√≠tima'] === 'Tentativa de assassinato').length;
            
            document.getElementById('total-cases').textContent = totalCases;
            document.getElementById('total-deaths').textContent = totalDeaths;
            document.getElementById('total-attempts').textContent = totalAttempts;
        });
    </script>
</body>
</html>
